<%- include("../partials/header") %>

    <div class="container">
        <!-- Game details section here -->
        <div class="game-details">
            <h1>
                <%= game.title %>
            </h1>
            <div class="preview">
                <div class="carousel">

                    <div class="carousel__track-container">
                        <ul class="carousel__track">
                            <% for (let i=0; i < 4; i++) { %>
                                <li class="carousel__slide <%= i === 0 ? 'current-slide' : '' %>">
                                    <img class="carousel__image"
                                        src="/images/game-previews/<%= game.title %>/<%= i %>.jpg" alt="">
                                </li>
                                <% } %>
                        </ul>
                    </div>
                    <button class="carousel__button carousel__button--left"></button>
                    <button class="carousel__button carousel__button--right"></button>

                    <div class="carousel__nav">
                        <% for (let i=0; i < 4; i++) { %>
                            <button class="carousel__indicator <%= i === 0 ? 'current-slide' : '' %>">
                                <img class="carousel__nav-image"
                                    src="/images/game-previews/<%= game.title %>/<%= i %>.jpg" alt="">
                            </button>
                            <% } %>
                    </div>

                </div>
            </div>
            <div class="elaborated-details">
                <%= game.description %>
            </div>
            <div class="details">Details of Game</div>
            <div class="sidebar">Requirements, Languages, Localities, Links to Share</div>
        </div>

        <!-- Review section -->
        <div class="review-section">
            <% if (user) { %>
                <button id="review-game-btn" class="review-game-btn">Review Game</button>
                <% } %>
        </div>
        <div class="reviews">
            <!-- reviews loop -->

            <div class="recent-reviews">
                <h3>RECENT REVIEWS</h3>
                <% game.reviews.forEach(function(review) { %>
                    <div class="review">
                        <p><strong>
                                <%= review.userName %>
                            </strong></p>
                        <p>
                            <%= review.content %>
                        </p>
                        <p>Rating: <%= review.rating %> stars</p>
                    </div>
                    <% }) %>
            </div>
            <div class="review-control">
                <% if (user) { %>
                    <a href="/games/<%= game._id %>/reviews/<%= game.reviews._id %>">Edit Review</a>
                    <form action="/games/<%= game._id %>/reviews/<%= game.reviews._id %>?_method=DELETE" method="POST">
                        <button type="review-submit">Delete Review</button>
                    </form>
                    <% } %>
            </div>
        </div>

    </div>

    <!-- Review Modal -->

    <div id="review-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Writing Your Review</h2>
            <p>Reminder of terms or things that user has to agree to review (rules):</p>
            <form action="/games/<%= game._id %>/reviews" method="POST">
                <div class="form-group">
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="title" required>
                </div>
                <div class="form-group">
                    <label for="rating">Rating:</label>
                    <select id="rating" name="rating" required>
                        <option value=1>1</option>
                        <option value=2>2</option>
                        <option value=3>3</option>
                        <option value=4>4</option>
                        <option value=5>5</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="content">Description:</label>
                    <textarea id="content" name="content" rows="5" required></textarea>
                </div>
                <div class="form-group">
                    <button type="review-submit" class="submit-btn">Submit</button>
                </div>
            </form>
        </div>
    </div>

    <% if (user) { %>
        <a href="/games/<%= game._id %>/edit">Edit</a>
        <form action="/games/<%= game._id %>?_method=DELETE" method="POST">
            <button type="submit">Delete</button>
        </form>
        <% } %>


            <script src="/javascripts/carousel.js"></script>
            <script src="/javascripts/show.js"></script>

            <%- include("../partials/footer") %>